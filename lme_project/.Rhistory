facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 16, margin = margin(r = 10)),
strip.text       = element_text(size = 16, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "left",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (UG baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#5BCEFA",                   # Light blue
"interaction" = "#B388EB",                  # Soft purple
"anhedonia" = "#F5A9B8"                     # Light pink
)
# Custom facet labels
facet_labels <- c(
f0 = "initial norm",
envy = "norm aversion",
beta = "inverse temperature"
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("f0", "envy", "beta"))
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (UG baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#5BCEFA",                   # Light blue
"interaction" = "#B388EB",                  # Soft purple
"anhedonia" = "#F5A9B8"                     # Light pink
)
# Custom facet labels
facet_labels <- c(
f0 = "initial norm",
envy = "norm aversion",
beta = "inverse temperature"
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("f0", "envy", "beta"))
)
coef_all$term_clean <- factor(coef_all$term_clean, levels = c("depression", "interaction", "anhedonia"))
pattern_map <- c("depression" = "stripe", "interaction" = "circle", "anhedonia" = "crosshatch")
scale_pattern_manual(values = pattern_map)
install.packages("ggpattern")
library(ggpattern)
install.packages("ggpattern")
library(ggpattern)
library(ggpattern)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#abb9f5",
"anhedonia" = "#778DEF",
"interaction" = "#4261E9"
)
# Custom facet labels
facet_labels <- c(
f0 = "initial norm",
envy = "norm aversion",
beta = "inverse temperature"
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("f0", "envy", "beta"))
)
scale_pattern_manual(values = pattern_map)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (UG baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#abb9f5",
"interaction" = "#778DEF",
"anhedonia" = "#4261E9",
)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#abb9f5",
"interaction" = "#778DEF",
"anhedonia" = "#4261E9"
)
# Custom facet labels
facet_labels <- c(
f0 = "initial norm",
envy = "norm aversion",
beta = "inverse temperature"
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("f0", "envy", "beta"))
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (UG baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#abb9f5",
"interaction" = "#5D77EC",
"anhedonia" = "#193CD6"
)
# Custom facet labels
facet_labels <- c(
f0 = "initial norm",
envy = "norm aversion",
beta = "inverse temperature"
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("f0", "envy", "beta"))
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, labeller = as_labeller(facet_labels), nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (UG baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
coef_all <- bind_rows(
extract_coefs(rl.alphaneg, "negative alpha"),
extract_coefs(rl.alphapos, "positive alpha"),
extract_coefs(rl.beta, "inverse temperature")
)
# Factor ordering
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "anhedonia", "interaction")),
model = factor(model, levels = c("negative alpha", "positive alpha", "inverse temperature"))
)
# Compute fixed star heights per model
y_star_pos <- coef_all %>%
group_by(model) %>%
summarise(y = max(conf.high) + 0.1)
coef_all <- left_join(coef_all, y_star_pos, by = "model")
# Custom fill colors (Pride flag–inspired)
fill_colors <- c(
"depression" = "#f5abb9",                   # Light blue
"interaction" = "#EC5D77",                  # Soft purple
"anhedonia" = "#D6193C"                     # Light pink
)
# Ensure custom bar order
coef_all <- coef_all %>%
mutate(
term_clean = factor(term_clean, levels = c("depression", "interaction", "anhedonia")),
model = factor(model, levels = c("negative alpha", "positive alpha", "inverse temperature"))
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "left",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
#facet_wrap(~model, nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "left",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, nrow = 1, scales = "free_y") +    # force 1 row
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "left",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
coef_all
ggplot(coef_all, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +  # skinnier bars, less space
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +  # bigger stars
facet_wrap(~model, nrow = 1) +    # force 1 row
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +  # increase base font size
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
strip.text       = element_text(size = 18, face = "plain"),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "left",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10),  # tighter margins
strip.placement  = "outside",              # put facet labels outside panels
panel.spacing    = unit(0.8, "lines")      # reduce spacing between panels
)
# Filter for inverse temperature only
coef_beta <- coef_all %>% filter(model == "beta")
ggplot(coef_beta, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL, title = "inverse temperature") +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
plot.title       = element_text(size = 18, face = "plain", hjust = 0.5),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10)
)
# Filter for inverse temperature only
coef_beta <- coef_all %>% filter(model == "inverse temperature")
ggplot(coef_beta, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL, title = "inverse temperature") +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
plot.title       = element_text(size = 18, face = "plain", hjust = 0.5),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10)
)
library(scales)
ggplot(coef_beta, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +
labs(x = NULL, y = "coefficient (RL baseline)", fill = NULL, title = "inverse temperature") +
scale_fill_manual(values = fill_colors) +
scale_y_continuous(labels = scientific, expand = expansion(mult = c(0, 0.1))) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
plot.title       = element_text(size = 18, face = "plain", hjust = 0.5),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10)
)
View(coef_beta)
coef_beta <- coef_beta %>%
mutate(
Estimate = Estimate * 1e6,
conf.low = conf.low * 1e6,
conf.high = conf.high * 1e6,
y = y * 1e6
)
ggplot(coef_beta, aes(x = term_clean, y = Estimate, fill = term_clean)) +
geom_bar(stat = "identity", width = 0.55) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.1) +
geom_text(aes(y = y, label = sig_label), size = 10, color = "black") +
labs(
x = NULL,
y = expression("coefficient ("*10^{-6}*")"),
fill = NULL,
title = "inverse temperature"
) +
scale_fill_manual(values = fill_colors) +
coord_cartesian(clip = "off") +
theme_minimal(base_size = 18) +
theme(
panel.grid       = element_blank(),
axis.text.x      = element_blank(),
axis.ticks.x     = element_blank(),
axis.text.y      = element_text(size = 16),
axis.title.y     = element_text(size = 18, margin = margin(r = 10)),
plot.title       = element_text(size = 18, face = "plain", hjust = 0.5),
legend.position  = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.box       = "horizontal",
legend.text      = element_text(size = 16),
plot.margin      = margin(10, 10, 10, 10)
)
