"0","normalize = function(x) {"
"0","  return ((x - mean(x)) / sd(x))"
"0","}"
"0",""
"0","var_recode = function(data){"
"0","  data$age_z = normalize(data$age)"
"0","  data$edu_z = normalize(data$edu_level)"
"0","  data$income_z = normalize(data$income_order)"
"0","  data$ses = data$edu_z + data$income_z"
"0","  data$poc = ifelse(data$race == ""White"", 0, 1) # POC coded as 1"
"0","  data$poc = factor(data$poc)"
"0","  data$female <- ifelse(data$sex == 2, 1, 0)  # Female=1, Male+Other=0"
"0","  #data$female <- ifelse(data$sex == 2, 1, "
"0","                      #ifelse(data$sex == 3, NA, 0)) # Female coded as 1, Other as NA, Male as 0, row 150"
"0","  data$female = factor(data$female)"
"0","  data$group = factor(data$group, levels = c(""Healthy"", ""Depression"", ""Anhedonia"", ""Both""))"
"0","  "
"0","  # mean centering for main effect"
"0","  data$depression_mc = data$depression - mean(data$depression)"
"0","  data$anhedonia_mc = data$anhedonia - mean(data$anhedonia)"
"0","  "
"0","  return(data)"
"0","}"
"0",""
"0","write_lme_results_to_excel = function(lme_model, filename) {"
"0","  library(openxlsx)"
"0",""
"0","  # Get summary of the model"
"0","  summary_table = summary(lme_model)"
"0","  "
"0","  # Extract fixed effects"
"0","  fixed_effects_df = data.frame(variable = rownames(summary_table$coefficients),    summary_table$coefficients, row.names = NULL)"
"0","  "
"0","  # Extract random effect"
"0","  random_effects = summary_table$varcor"
"0","  "
"0","  # Get ANOVA table of the model"
"0","  anova_table = anova(lme_model)"
"0","  anova_df = data.frame(variable = rownames(anova_table), anova_table, row.names = NULL)"
"0","  "
"0","  # Get performance table of the model"
"0","  perf_table = performance::performance(lme_model)"
"0","  perf_df = data.frame(metric = names(perf_table), value = unlist(perf_table), row.names = NULL)"
"0","  "
"0","  # Create a new Excel workbook"
"0","  wb = createWorkbook()"
"0","  "
"0","  # Add a new worksheet for fixed effects"
"0","  addWorksheet(wb, ""Fixed Effects"")"
"0","  writeData(wb, ""Fixed Effects"", fixed_effects_df, startCol = 1, startRow = 1, colNames = TRUE)"
"0","  "
"0","  # Add a new worksheet for random effects"
"0","  addWorksheet(wb, ""Random Effects"")"
"0","  writeData(wb, ""Random Effects"", random_effects, startCol = 1, startRow = 1, colNames = TRUE)"
"0","  "
"0","  # Add a new worksheet for ANOVA results"
"0","  addWorksheet(wb, ""ANOVA"")"
"0","  writeData(wb, ""ANOVA"", anova_df, startCol = 1, startRow = 1, colNames = TRUE)"
"0","  "
"0","  addWorksheet(wb, ""Performance"")"
"0","  writeData(wb, ""Performance"", perf_df, startCol = 1, startRow = 1, colNames = TRUE)"
"0","  "
"0","  # Save the workbook to a file"
"0","  saveWorkbook(wb, filename, overwrite = TRUE)"
"0","}"
